
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>Index - Apache Celeborn (Incubating)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#configuration-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Apache Celeborn (Incubating)" class="md-header__button md-logo" aria-label="Apache Celeborn (Incubating)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Apache Celeborn (Incubating)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Index
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/apache/incubating-celeborn" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    apache/incubating-celeborn
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="./" class="md-tabs__link md-tabs__link--active">
        Configuration
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../contrib/docs_and_website/" class="md-tabs__link">
        Contributor
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Apache Celeborn (Incubating)" class="md-nav__button md-logo" aria-label="Apache Celeborn (Incubating)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Apache Celeborn (Incubating)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/apache/incubating-celeborn" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    apache/incubating-celeborn
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index md-nav__link--active">
          <a href="./">Configuration</a>
          
        </div>
      
      <nav class="md-nav" aria-label="Configuration" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Contributor
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributor" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Contributor
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../contrib/docs_and_website/" class="md-nav__link">
        Docs and Website
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#important-configurations" class="md-nav__link">
    Important Configurations
  </a>
  
    <nav class="md-nav" aria-label="Important Configurations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environment-variables" class="md-nav__link">
    Environment Variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#all-configurations" class="md-nav__link">
    All Configurations
  </a>
  
    <nav class="md-nav" aria-label="All Configurations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#client" class="md-nav__link">
    Client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#columnar-shuffle" class="md-nav__link">
    Columnar Shuffle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master" class="md-nav__link">
    Master
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#worker" class="md-nav__link">
    Worker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quota" class="md-nav__link">
    Quota
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network" class="md-nav__link">
    Network
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    Metrics
  </a>
  
    <nav class="md-nav" aria-label="Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metricsproperties" class="md-nav__link">
    metrics.properties
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-variables_1" class="md-nav__link">
    Environment Variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuning" class="md-nav__link">
    Tuning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#worker-recover-status-after-restart" class="md-nav__link">
    Worker Recover Status After Restart
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/apache/incubating-celeborn/edit/master/docs/configuration/index.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="configuration-guide">Configuration Guide</h1>
<p>This documentation contains Celeborn configuration details and a tuning guide.</p>
<h2 id="important-configurations">Important Configurations</h2>
<h3 id="environment-variables">Environment Variables</h3>
<ul>
<li><code>CELEBORN_WORKER_MEMORY=4g</code></li>
<li><code>CELEBORN_WORKER_OFFHEAP_MEMORY=24g</code></li>
</ul>
<p>Celeborn workers tend to improve performance by using off-heap buffers.
Off-heap memory requirement can be estimated as below:</p>
<pre><code>numDirs = `celeborn.worker.storage.dirs`             # the amount of directory will be used by Celeborn storage
bufferSize = `celeborn.worker.flusher.buffer.size`   # the amount of memory will be used by a single flush buffer 
off-heap-memory = bufferSize * estimatedTasks * 2 + network memory
</code></pre>
<p>For example, if an Celeborn worker has 10 storage directories or disks and the buffer size is set to 256 KiB.
The necessary off-heap memory is 10 GiB.</p>
<p>Network memory will be consumed when netty reads from a TPC channel, there will need some extra
memory. Empirically, Celeborn worker off-heap memory should be set to <code>(numDirs  * bufferSize * 1.2)</code>.</p>
<h2 id="all-configurations">All Configurations</h2>
<h3 id="client">Client</h3>
<!-- BEGIN INCLUDE ./client.md '&lt;!--begin-include--&gt;' '&lt;!--end-include--&gt;' -->

<table>
<thead>
<tr>
<th>Key</th>
<th>Default</th>
<th>Description</th>
<th>Since</th>
</tr>
</thead>
<tbody>
<tr>
<td>celeborn.application.heartbeatInterval</td>
<td>10s</td>
<td>Interval for client to send heartbeat message to master.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.client.maxRetries</td>
<td>15</td>
<td>Max retry times for client to connect master endpoint</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.client.rpc.askTimeout</td>
<td>&lt;value of celeborn.network.timeout&gt;</td>
<td>Timeout for client RPC ask operations.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.fetch.maxReqsInFlight</td>
<td>3</td>
<td>Amount of in-flight chunk fetch request.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.fetch.maxRetries</td>
<td>3</td>
<td>Max retries of fetch chunk</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.fetch.timeout</td>
<td>120s</td>
<td>Timeout for a task to fetch chunk.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.master.endpoints</td>
<td>&lt;localhost&gt;:9097</td>
<td>Endpoints of master nodes for celeborn client to connect, allowed pattern is: <code>&lt;host1&gt;:&lt;port1&gt;[,&lt;host2&gt;:&lt;port2&gt;]*</code>, e.g. <code>clb1:9097,clb2:9098,clb3:9099</code>. If the port is omitted, 9097 will be used.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.push.buffer.initial.size</td>
<td>8k</td>
<td></td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.push.buffer.max.size</td>
<td>64k</td>
<td>Max size of reducer partition buffer memory for shuffle hash writer. The pushed data will be buffered in memory before sending to Celeborn worker. For performance consideration keep this buffer size higher than 32K. Example: If reducer amount is 2000, buffer size is 64K, then each task will consume up to <code>64KiB * 2000 = 125MiB</code> heap memory.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.push.limit.inFlight.sleepInterval</td>
<td>50ms</td>
<td>Sleep interval when check netty in-flight requests to be done.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.push.limit.inFlight.timeout</td>
<td>240s</td>
<td>Timeout for netty in-flight requests to be done.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.push.maxReqsInFlight</td>
<td>32</td>
<td>Amount of Netty in-flight requests. The maximum memory is <code>celeborn.push.maxReqsInFlight</code> * <code>celeborn.push.buffer.max.size</code> * compression ratio(1 in worst case), default: 64Kib * 32 = 2Mib</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.push.queue.capacity</td>
<td>512</td>
<td>Push buffer queue size for a task. The maximum memory is <code>celeborn.push.buffer.max.size</code> * <code>celeborn.push.queue.capacity</code>, default: 64KiB * 512 = 32MiB</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.push.replicate.enabled</td>
<td>true</td>
<td>When true, Celeborn worker will replicate shuffle data to another Celeborn worker asynchronously to ensure the pushed shuffle data won't be lost after the node failure.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.push.retry.threads</td>
<td>8</td>
<td>Thread number to process shuffle re-send push data requests.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.push.sortMemory.threshold</td>
<td>64m</td>
<td>When SortBasedPusher use memory over the threshold, will trigger push data.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.push.splitPartition.threads</td>
<td>8</td>
<td>Thread number to process shuffle split request in shuffle client.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.push.stageEnd.timeout</td>
<td>240s</td>
<td>Timeout for StageEnd.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.rpc.cache.concurrencyLevel</td>
<td>32</td>
<td>The number of write locks to update rpc cache.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.rpc.cache.expireTime</td>
<td>15s</td>
<td>The time before a cache item is removed.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.rpc.cache.size</td>
<td>256</td>
<td>The max cache items count for rpc cache.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.rpc.maxParallelism</td>
<td>1024</td>
<td>Max parallelism of client on sending RPC requests.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.rpc.requestCommitFiles.maxRetries</td>
<td>2</td>
<td>Max retry times for requestCommitFiles RPC.</td>
<td>1.0.0</td>
</tr>
<tr>
<td>celeborn.shuffle.batchHandleChangePartition.enabled</td>
<td>false</td>
<td>When true, LifecycleManager will handle change partition request in batch. Otherwise, LifecycleManager will process the requests one by one</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.batchHandleChangePartition.interval</td>
<td>100ms</td>
<td>Interval for LifecycleManager to schedule handling change partition requests in batch.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.batchHandleChangePartition.threads</td>
<td>8</td>
<td>Threads number for LifecycleManager to handle change partition request in batch.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.chuck.size</td>
<td>8m</td>
<td>Max chunk size of reducer's merged shuffle data. For example, if a reducer's shuffle data is 128M and the data will need 16 fetch chunk requests to fetch.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.compression.codec</td>
<td>LZ4</td>
<td>The codec used to compress shuffle data. By default, Celeborn provides two codecs: <code>lz4</code> and <code>zstd</code>.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.compression.zstd.level</td>
<td>1</td>
<td>Compression level for Zstd compression codec, its value should be an integer between -5 and 22. Increasing the compression level will result in better compression at the expense of more CPU and memory.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.expired.checkInterval</td>
<td>60s</td>
<td>Interval for client to check expired shuffles.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.forceFallback.enabled</td>
<td>false</td>
<td>Whether force fallback shuffle to Spark's default.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.forceFallback.numPartitionsThreshold</td>
<td>500000</td>
<td>Celeborn will only accept shuffle of partition number lower than this configuration value.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.manager.port</td>
<td>0</td>
<td>Port used by the LifecycleManager on the Driver.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.partition.type</td>
<td>REDUCE</td>
<td>Type of shuffle's partition.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.partitionSplit.mode</td>
<td>SOFT</td>
<td>soft: the shuffle file size might be larger than split threshold. hard: the shuffle file size will be limited to split threshold.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.partitionSplit.threshold</td>
<td>1G</td>
<td>Shuffle file size threshold, if file size exceeds this, trigger split.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.rangeReadFilter.enabled</td>
<td>false</td>
<td>If a spark application have skewed partition, this value can set to true to improve performance.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.register.maxRetries</td>
<td>3</td>
<td>Max retry times for client to register shuffle.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.register.retryWait</td>
<td>3s</td>
<td>Wait time before next retry if register shuffle failed.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.writer</td>
<td>HASH</td>
<td>Celeborn supports the following kind of shuffle writers. 1. hash: hash-based shuffle writer works fine when shuffle partition count is normal; 2. sort: sort-based shuffle writer works fine when memory pressure is high or shuffle partition count it huge.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.slots.reserve.maxRetries</td>
<td>3</td>
<td>Max retry times for client to reserve slots.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.slots.reserve.retryWait</td>
<td>3s</td>
<td>Wait time before next retry if reserve slots failed.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.storage.hdfs.dir</td>
<td>&lt;undefined&gt;</td>
<td>HDFS dir configuration for Celeborn to access HDFS.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.test.fetchFailure</td>
<td>false</td>
<td>Wheter to test fetch chunk failure</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.test.retryCommitFiles</td>
<td>false</td>
<td>Fail commitFile request for test</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.excluded.checkInterval</td>
<td>30s</td>
<td>Interval for client to refresh excluded worker list.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.excluded.expireTimeout</td>
<td>600s</td>
<td>Timeout time for LifecycleManager to clear reserved excluded worker.</td>
<td>0.2.0</td>
</tr>
</tbody>
</table>
<!-- END INCLUDE -->

<h3 id="columnar-shuffle">Columnar Shuffle</h3>
<!-- BEGIN INCLUDE ./columnar-shuffle.md '&lt;!--begin-include--&gt;' '&lt;!--end-include--&gt;' -->

<table>
<thead>
<tr>
<th>Key</th>
<th>Default</th>
<th>Description</th>
<th>Since</th>
</tr>
</thead>
<tbody>
<tr>
<td>celeborn.columnar.offHeap.enabled</td>
<td>false</td>
<td>Whether to use off heap columnar vector.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.columnar.shuffle.batch.size</td>
<td>10000</td>
<td>Vector batch size for columnar shuffle.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.columnar.shuffle.codegen.enabled</td>
<td>false</td>
<td>Whether to use codegen for columnar-based shuffle.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.columnar.shuffle.enabled</td>
<td>false</td>
<td>Whether to enable columnar-based shuffle.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.columnar.shuffle.encoding.dictionary.enabled</td>
<td>false</td>
<td>Whether to use dictionary encoding for columnar-based shuffle data.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.columnar.shuffle.encoding.dictionary.maxFactor</td>
<td>0.3</td>
<td>Max factor for dictionary size. The max dictionary size is <code>min(32.0 KB, celeborn.columnar.shuffle.batch.size * celeborn.columnar.shuffle.encoding.dictionary.maxFactor)</code>.</td>
<td>0.2.0</td>
</tr>
</tbody>
</table>
<!-- END INCLUDE -->

<h3 id="master">Master</h3>
<!-- BEGIN INCLUDE ./master.md '&lt;!--begin-include--&gt;' '&lt;!--end-include--&gt;' -->

<table>
<thead>
<tr>
<th>Key</th>
<th>Default</th>
<th>Description</th>
<th>Since</th>
</tr>
</thead>
<tbody>
<tr>
<td>celeborn.application.heartbeat.timeout</td>
<td>120s</td>
<td>Application heartbeat timeout.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.ha.enabled</td>
<td>false</td>
<td>When true, master nodes run as Raft cluster mode.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.ha.master.node.&lt;id&gt;.host</td>
<td>&lt;required&gt;</td>
<td>Host to bind of master node <id> in HA mode.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.ha.master.node.&lt;id&gt;.port</td>
<td>9097</td>
<td>Port to bind of master node <id> in HA mode.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.ha.master.node.&lt;id&gt;.ratis.port</td>
<td>9872</td>
<td>Ratis port to bind of master node <id> in HA mode.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.ha.master.ratis.raft.rpc.type</td>
<td>netty</td>
<td>RPC type for Ratis, available options: netty, grpc.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.ha.master.ratis.raft.server.storage.dir</td>
<td>/tmp/ratis</td>
<td></td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.master.host</td>
<td>&lt;localhost&gt;</td>
<td>Hostname for master to bind.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.master.metrics.prometheus.host</td>
<td>0.0.0.0</td>
<td>Master's Prometheus host.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.master.metrics.prometheus.port</td>
<td>9098</td>
<td>Master's Prometheus port.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.master.port</td>
<td>9097</td>
<td>Port for master to bind.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.app.topDiskUsage.count</td>
<td>50</td>
<td>Size for top items about top disk usage applications list.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.app.topDiskUsage.interval</td>
<td>10min</td>
<td>Time length for a window about top disk usage application list.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.app.topDiskUsage.windowSize</td>
<td>24</td>
<td>Window size about top disk usage application list.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.capacity</td>
<td>4096</td>
<td>The maximum number of metrics which a source can use to generate output strings.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.collectPerfCritical.enabled</td>
<td>false</td>
<td>It controls whether to collect metrics which may affect performance. When enable, Celeborn collects them.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.enabled</td>
<td>true</td>
<td>When true, enable metrics system.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.sample.rate</td>
<td>1.0</td>
<td>It controls if Celeborn collect timer metrics for some operations. Its value should be in [0.0, 1.0].</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.timer.slidingWindow.size</td>
<td>4096</td>
<td>The sliding window size of timer metric.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.estimatedPartitionSize.update.initialDelay</td>
<td>5min</td>
<td>Initial delay time before start updating partition size for estimation.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.estimatedPartitionSize.update.interval</td>
<td>10min</td>
<td>Interval of updating partition size for estimation.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.initialEstimatedPartitionSize</td>
<td>64mb</td>
<td>Initial partition size for estimation, it will change according to runtime stats.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.slots.assign.extraSlots</td>
<td>2</td>
<td>Extra slots number when master assign slots.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.slots.assign.loadAware.diskGroupGradient</td>
<td>0.1</td>
<td>This value means how many more workload will be placed into a faster disk group than a slower group.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.slots.assign.loadAware.numDiskGroups</td>
<td>5</td>
<td>This configuration is a guidance for load-aware slot allocation algorithm. This value is control how many disk groups will be created.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.slots.assign.policy</td>
<td>ROUNDROBIN</td>
<td>Policy for master to assign slots, Celeborn supports two types of policy: roundrobin and loadaware.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.heartbeat.timeout</td>
<td>120s</td>
<td>Worker heartbeat timeout.</td>
<td>0.2.0</td>
</tr>
</tbody>
</table>
<!-- END INCLUDE -->

<h3 id="worker">Worker</h3>
<!-- BEGIN INCLUDE ./worker.md '&lt;!--begin-include--&gt;' '&lt;!--end-include--&gt;' -->

<table>
<thead>
<tr>
<th>Key</th>
<th>Default</th>
<th>Description</th>
<th>Since</th>
</tr>
</thead>
<tbody>
<tr>
<td>celeborn.client.maxRetries</td>
<td>15</td>
<td>Max retry times for client to connect master endpoint</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.master.endpoints</td>
<td>&lt;localhost&gt;:9097</td>
<td>Endpoints of master nodes for celeborn client to connect, allowed pattern is: <code>&lt;host1&gt;:&lt;port1&gt;[,&lt;host2&gt;:&lt;port2&gt;]*</code>, e.g. <code>clb1:9097,clb2:9098,clb3:9099</code>. If the port is omitted, 9097 will be used.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.capacity</td>
<td>4096</td>
<td>The maximum number of metrics which a source can use to generate output strings.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.collectPerfCritical.enabled</td>
<td>false</td>
<td>It controls whether to collect metrics which may affect performance. When enable, Celeborn collects them.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.enabled</td>
<td>true</td>
<td>When true, enable metrics system.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.sample.rate</td>
<td>1.0</td>
<td>It controls if Celeborn collect timer metrics for some operations. Its value should be in [0.0, 1.0].</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.timer.slidingWindow.size</td>
<td>4096</td>
<td>The sliding window size of timer metric.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.chuck.size</td>
<td>8m</td>
<td>Max chunk size of reducer's merged shuffle data. For example, if a reducer's shuffle data is 128M and the data will need 16 fetch chunk requests to fetch.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.minPartitionSizeToEstimate</td>
<td>8mb</td>
<td>Ignore partition size smaller than this configuration of partition size for estimation.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.storage.hdfs.dir</td>
<td>&lt;undefined&gt;</td>
<td>HDFS dir configuration for Celeborn to access HDFS.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.closeIdleConnections</td>
<td>false</td>
<td>Whether worker will close idle connections.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.commit.threads</td>
<td>32</td>
<td>Thread number of worker to commit shuffle data files asynchronously.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.directMemoryRatioToPauseReceive</td>
<td>0.85</td>
<td>If direct memory usage reaches this limit, the worker will stop to receive data from Celeborn shuffle clients.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.directMemoryRatioToPauseReplicate</td>
<td>0.95</td>
<td>If direct memory usage reaches this limit, the worker will stop to receive replication data from other workers.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.directMemoryRatioToResume</td>
<td>0.5</td>
<td>If direct memory usage is less than this limit, worker will resume.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.disk.check.timeout</td>
<td>30s</td>
<td>Timeout time for worker check device status.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.disk.checkFileClean.maxRetries</td>
<td>3</td>
<td>The number of retries for a worker to check if the working directory is cleaned up before registering with the master.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.disk.checkFileClean.timeout</td>
<td>1000ms</td>
<td>The wait time per retry for a worker to check if the working directory is cleaned up before registering with the master.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.disk.reserve.size</td>
<td>5G</td>
<td>Celeborn worker reserved space for each disk.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.fetch.io.threads</td>
<td>&lt;undefined&gt;</td>
<td>Netty IO thread number of worker to handle client fetch data. The default threads number is <code>size(celeborn.worker.storage.dirs)*2</code>.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.fetch.port</td>
<td>0</td>
<td>Server port for Worker to receive fetch data request from ShuffleClient.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.flusher.avgFlushTime.slidingWindow.size</td>
<td>20</td>
<td>The size of sliding windows used to calculate statistics about flushed time and count.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.flusher.buffer.size</td>
<td>256k</td>
<td>Size of buffer used by a single flusher.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.flusher.hdd.threads</td>
<td>1</td>
<td>Flusher's thread count per disk used for write data to HDD disks.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.flusher.hdfs.threads</td>
<td>4</td>
<td>Flusher's thread count used for write data to HDFS.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.flusher.shutdownTimeout</td>
<td>3s</td>
<td>Timeout for a flusher to shutdown.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.flusher.ssd.threads</td>
<td>8</td>
<td>Flusher's thread count per disk used for write data to SSD disks.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.graceful.shutdown.checkSlotsFinished.interval</td>
<td>1s</td>
<td>The wait interval of checking whether all released slots to be committed or destroyed during worker graceful shutdown</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.graceful.shutdown.checkSlotsFinished.timeout</td>
<td>480s</td>
<td>The wait time of waiting for the released slots to be committed or destroyed during worker graceful shutdown.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.graceful.shutdown.enabled</td>
<td>false</td>
<td>When true, during worker shutdown, the worker will wait for all released slots to be committed or destroyed.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.graceful.shutdown.partitionSorter.shutdownTimeout</td>
<td>120s</td>
<td>The wait time of waiting for sorting partition files during worker graceful shutdown.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.graceful.shutdown.recoverPath</td>
<td>&lt;tmp&gt;/recover</td>
<td>The path to store levelDB.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.graceful.shutdown.timeout</td>
<td>600s</td>
<td>The worker's graceful shutdown timeout time.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.heartbeat.timeout</td>
<td>120s</td>
<td>Worker heartbeat timeout.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.memory.checkInterval</td>
<td>10ms</td>
<td>Interval of worker direct memory checking.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.memory.reportInterval</td>
<td>10s</td>
<td>Interval of worker direct memory tracker reporting to log.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.metrics.prometheus.host</td>
<td>0.0.0.0</td>
<td>Worker's Prometheus host.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.metrics.prometheus.port</td>
<td>9096</td>
<td>Worker's Prometheus port.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.monitor.disk.checkInterval</td>
<td>60s</td>
<td>Intervals between device monitor to check disk.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.monitor.disk.checklist</td>
<td>readwrite,diskusage</td>
<td>Monitor type for disk, available items are: iohang, readwrite and diskusage.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.monitor.disk.enabled</td>
<td>true</td>
<td>When true, worker will monitor device and report to master.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.monitor.disk.sys.block.dir</td>
<td>/sys/block</td>
<td>The directory where linux file block information is stored.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.noneEmptyDirExpireDuration</td>
<td>1d</td>
<td>If a non-empty application shuffle data dir have not been operated during le duration time, will mark this application as expired.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.partitionSorter.directMemoryRatioThreshold</td>
<td>0.1</td>
<td>Max ratio of partition sorter's memory for sorting, when reserved memory is higher than max partition sorter memory, partition sorter will stop sorting.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.partitionSorter.reservedMemoryPerPartition</td>
<td>1mb</td>
<td>Initial reserve memory when sorting a shuffle file off-heap.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.partitionSorter.sort.timeout</td>
<td>220s</td>
<td>Timeout for a shuffle file to sort.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.push.io.threads</td>
<td>&lt;undefined&gt;</td>
<td>Netty IO thread number of worker to handle client push data. The default threads number is <code>size(celeborn.worker.storage.dirs)*2</code>.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.push.port</td>
<td>0</td>
<td>Server port for Worker to receive push data request from ShuffleClient.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.register.timeout</td>
<td>180s</td>
<td>Worker register timeout.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.replicate.fastFail.duration</td>
<td>60s</td>
<td>If a replicate request not replied during the duration, worker will mark the replicate data request as failed.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.replicate.io.threads</td>
<td>&lt;undefined&gt;</td>
<td>Netty IO thread number of worker to replicate shuffle data. The default threads number is <code>size(celeborn.worker.storage.dirs)*2</code>.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.replicate.port</td>
<td>0</td>
<td>Server port for Worker to receive replicate data request from other Workers.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.replicate.threads</td>
<td>64</td>
<td>Thread number of worker to replicate shuffle data.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.rpc.port</td>
<td>0</td>
<td>Server port for Worker to receive RPC request.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.shuffle.commit.timeout</td>
<td>&lt;value of celeborn.rpc.askTimeout&gt;</td>
<td>Timeout for a Celeborn worker to commit files of a shuffle.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.storage.baseDir.number</td>
<td>16</td>
<td>How many directories will be used if <code>celeborn.worker.storage.dirs</code> is not set. The directory name is a combination of <code>celeborn.worker.storage.baseDir.prefix</code> and from one(inclusive) to <code>celeborn.worker.storage.baseDir.number</code>(inclusive) step by one.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.storage.baseDir.prefix</td>
<td>/mnt/disk</td>
<td>Base directory for Celeborn worker to write if <code>celeborn.worker.storage.dirs</code> is not set.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.storage.dirs</td>
<td>&lt;undefined&gt;</td>
<td>Directory list to store shuffle data. It's recommended to configure one directory on each disk. Storage size limit can be set for each directory. For the sake of performance, there should be no more than 2 flush threads on the same disk partition if you are using HDD, and should be 8 or more flush threads on the same disk partition if you are using SSD. For example: <code>dir1[:capacity=][:disktype=][:flushthread=],dir2[:capacity=][:disktype=][:flushthread=]</code></td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.workingDir</td>
<td>hadoop/rss-worker/shuffle_data</td>
<td>Worker's working dir path name.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.writer.close.timeout</td>
<td>120s</td>
<td>Timeout for a file writer to close</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.writer.create.maxAttempts</td>
<td>3</td>
<td>Retry count for a file writer to create if its creation was failed.</td>
<td>0.2.0</td>
</tr>
</tbody>
</table>
<!-- END INCLUDE -->

<h3 id="quota">Quota</h3>
<!-- BEGIN INCLUDE ./quota.md '&lt;!--begin-include--&gt;' '&lt;!--end-include--&gt;' -->

<table>
<thead>
<tr>
<th>Key</th>
<th>Default</th>
<th>Description</th>
<th>Since</th>
</tr>
</thead>
<tbody>
<tr>
<td>celeborn.quota.configuration.path</td>
<td>&lt;undefined&gt;</td>
<td>Quota configuration file path.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.quota.enabled</td>
<td>true</td>
<td>When true, before registering shuffle, LifecycleManager should check if current user have enough quota space, if cluster don't have enough quota space for current user, fallback to Spark's default shuffle</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.quota.identity.provider</td>
<td>org.apache.celeborn.common.identity.DefaultIdentityProvider</td>
<td>IdentityProvider class name. Default class is <code>org.apache.celeborn.common.identity.DefaultIdentityProvider</code>, return <code>org.apache.celeborn.common.identity.UserIdentifier</code> with default tenant id and username from <code>org.apache.hadoop.security.UserGroupInformation</code>.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.quota.manager</td>
<td>org.apache.celeborn.common.quota.DefaultQuotaManager</td>
<td>QuotaManger class name. Default class is <code>org.apache.celeborn.common.quota.DefaultQuotaManager</code>.</td>
<td>0.2.0</td>
</tr>
</tbody>
</table>
<!-- END INCLUDE -->

<h3 id="network">Network</h3>
<!-- BEGIN INCLUDE ./network.md '&lt;!--begin-include--&gt;' '&lt;!--end-include--&gt;' -->

<table>
<thead>
<tr>
<th>Key</th>
<th>Default</th>
<th>Description</th>
<th>Since</th>
</tr>
</thead>
<tbody>
<tr>
<td>celeborn.&lt;module&gt;.decoder.mode</td>
<td>default</td>
<td>Netty TransportFrameDecoder implementation, available options: default, supplier.</td>
<td></td>
</tr>
<tr>
<td>celeborn.&lt;module&gt;.io.backLog</td>
<td>0</td>
<td>Requested maximum length of the queue of incoming connections. Default 0 for no backlog.</td>
<td></td>
</tr>
<tr>
<td>celeborn.&lt;module&gt;.io.clientThreads</td>
<td>0</td>
<td>Number of threads used in the client thread pool. Default to 0, which is 2x#cores.</td>
<td></td>
</tr>
<tr>
<td>celeborn.&lt;module&gt;.io.connectTimeout</td>
<td>&lt;value of celeborn.network.connect.timeout&gt;</td>
<td>Socket connect timeout.</td>
<td></td>
</tr>
<tr>
<td>celeborn.&lt;module&gt;.io.connectionTimeout</td>
<td>&lt;value of celeborn.network.timeout&gt;</td>
<td>Connection active timeout.</td>
<td></td>
</tr>
<tr>
<td>celeborn.&lt;module&gt;.io.enableVerboseMetrics</td>
<td>false</td>
<td>Whether to track Netty memory detailed metrics. If true, the detailed metrics of Netty PoolByteBufAllocator will be gotten, otherwise only general memory usage will be tracked.</td>
<td></td>
</tr>
<tr>
<td>celeborn.&lt;module&gt;.io.lazyFD</td>
<td>true</td>
<td>Whether to initialize FileDescriptor lazily or not. If true, file descriptors are created only when data is going to be transferred. This can reduce the number of open files.</td>
<td></td>
</tr>
<tr>
<td>celeborn.&lt;module&gt;.io.maxRetries</td>
<td>3</td>
<td>Max number of times we will try IO exceptions (such as connection timeouts) per request. If set to 0, we will not do any retries.</td>
<td></td>
</tr>
<tr>
<td>celeborn.&lt;module&gt;.io.mode</td>
<td>NIO</td>
<td>Netty EventLoopGroup backend, available options: NIO, EPOLL.</td>
<td></td>
</tr>
<tr>
<td>celeborn.&lt;module&gt;.io.numConnectionsPerPeer</td>
<td>2</td>
<td>Number of concurrent connections between two nodes.</td>
<td></td>
</tr>
<tr>
<td>celeborn.&lt;module&gt;.io.preferDirectBufs</td>
<td>true</td>
<td>If true, we will prefer allocating off-heap byte buffers within Netty.</td>
<td></td>
</tr>
<tr>
<td>celeborn.&lt;module&gt;.io.receiveBuffer</td>
<td>0b</td>
<td>Receive buffer size (SO_RCVBUF). Note: the optimal size for receive buffer and send buffer should be latency * network_bandwidth. Assuming latency = 1ms, network_bandwidth = 10Gbps buffer size should be ~ 1.25MB.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.&lt;module&gt;.io.retryWait</td>
<td>5s</td>
<td>Time that we will wait in order to perform a retry after an IOException. Only relevant if maxIORetries &gt; 0.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.&lt;module&gt;.io.sendBuffer</td>
<td>0b</td>
<td>Send buffer size (SO_SNDBUF).</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.&lt;module&gt;.io.serverThreads</td>
<td>0</td>
<td>Number of threads used in the server thread pool. Default to 0, which is 2x#cores.</td>
<td></td>
</tr>
<tr>
<td>celeborn.network.connect.timeout</td>
<td>10s</td>
<td>Default socket connect timeout.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.network.timeout</td>
<td>240s</td>
<td>Default timeout for network operations.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.port.maxRetries</td>
<td>1</td>
<td>When port is occupied, we will retry for max retry times.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.rpc.askTimeout</td>
<td>&lt;value of celeborn.network.timeout&gt;</td>
<td>Timeout for RPC ask operations.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.rpc.connect.threads</td>
<td>64</td>
<td></td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.rpc.lookupTimeout</td>
<td>30s</td>
<td>Timeout for RPC lookup operations.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.shuffle.maxChunksBeingTransferred</td>
<td>9223372036854775807</td>
<td>The max number of chunks allowed to be transferred at the same time on shuffle service. Note that new incoming connections will be closed when the max number is hit. The client will retry according to the shuffle retry configs (see <code>celeborn.shuffle.io.maxRetries</code> and <code>celeborn.shuffle.io.retryWait</code>), if those limits are reached the task will fail with fetch failure.</td>
<td>0.2.0</td>
</tr>
</tbody>
</table>
<!-- END INCLUDE -->

<h3 id="metrics">Metrics</h3>
<!-- BEGIN INCLUDE ./metrics.md '&lt;!--begin-include--&gt;' '&lt;!--end-include--&gt;' -->

<table>
<thead>
<tr>
<th>Key</th>
<th>Default</th>
<th>Description</th>
<th>Since</th>
</tr>
</thead>
<tbody>
<tr>
<td>celeborn.master.metrics.prometheus.host</td>
<td>0.0.0.0</td>
<td>Master's Prometheus host.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.master.metrics.prometheus.port</td>
<td>9098</td>
<td>Master's Prometheus port.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.capacity</td>
<td>4096</td>
<td>The maximum number of metrics which a source can use to generate output strings.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.collectPerfCritical.enabled</td>
<td>false</td>
<td>It controls whether to collect metrics which may affect performance. When enable, Celeborn collects them.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.enabled</td>
<td>true</td>
<td>When true, enable metrics system.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.sample.rate</td>
<td>1.0</td>
<td>It controls if Celeborn collect timer metrics for some operations. Its value should be in [0.0, 1.0].</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.metrics.timer.slidingWindow.size</td>
<td>4096</td>
<td>The sliding window size of timer metric.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.metrics.prometheus.host</td>
<td>0.0.0.0</td>
<td>Worker's Prometheus host.</td>
<td>0.2.0</td>
</tr>
<tr>
<td>celeborn.worker.metrics.prometheus.port</td>
<td>9096</td>
<td>Worker's Prometheus port.</td>
<td>0.2.0</td>
</tr>
</tbody>
</table>
<!-- END INCLUDE -->

<h4 id="metricsproperties">metrics.properties</h4>
<pre><code class="language-properties">*.sink.csv.class=org.apache.celeborn.common.metrics.sink.CsvSink
*.sink.prometheusServlet.class=org.apache.celeborn.common.metrics.sink.PrometheusServlet
</code></pre>
<h3 id="environment-variables_1">Environment Variables</h3>
<p>Recommend configuring in <code>conf/celeborn-env.sh</code>.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CELEBORN_HOME</code></td>
<td><code>$(cd "`dirname "$0"`"/..; pwd)</code></td>
<td></td>
</tr>
<tr>
<td><code>CELEBORN_CONF_DIR</code></td>
<td><code>${CELEBORN_CONF_DIR:-"${CELEBORN_HOME}/conf"}</code></td>
<td></td>
</tr>
<tr>
<td><code>CELEBORN_MASTER_MEMORY</code></td>
<td>1 GB</td>
<td></td>
</tr>
<tr>
<td><code>CELEBORN_WORKER_MEMORY</code></td>
<td>1 GB</td>
<td></td>
</tr>
<tr>
<td><code>CELEBORN_WORKER_OFFHEAP_MEMORY</code></td>
<td>1 GB</td>
<td></td>
</tr>
<tr>
<td><code>CELEBORN_MASTER_JAVA_OPTS</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>CELEBORN_WORKER_JAVA_OPTS</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>CELEBORN_PID_DIR</code></td>
<td><code>${CELEBORN_HOME}/pids</code></td>
<td></td>
</tr>
<tr>
<td><code>CELEBORN_LOG_DIR</code></td>
<td><code>${CELEBORN_HOME}/logs</code></td>
<td></td>
</tr>
<tr>
<td><code>CELEBORN_SSH_OPTS</code></td>
<td><code>-o StrictHostKeyChecking=no</code></td>
<td></td>
</tr>
<tr>
<td><code>CELEBORN_SLEEP</code></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="tuning">Tuning</h2>
<p>Assume we have a cluster described as below:
5 Celeborn Workers with 20 GB off-heap memory and 10 disks.
As we need to reserve 20% off-heap memory for netty,
so we could assume 16 GB off-heap memory can be used for flush buffers.</p>
<p>If <code>spark.celeborn.push.buffer.size</code> is 64 KB, we can have in-flight requests up to 1310720.
If you have 8192 mapper tasks, you could set <code>spark.celeborn.push.maxReqsInFlight=160</code> to gain performance improvements.</p>
<p>If <code>celeborn.worker.flush.buffer.size</code> is 256 KB, we can have total slots up to 327680 slots.</p>
<h2 id="worker-recover-status-after-restart">Worker Recover Status After Restart</h2>
<p><code>ShuffleClient</code> records the shuffle partition location's host, service port, and filename,
to support workers recovering reading existing shuffle data after worker restart,
during worker shutdown, workers should store the meta about reading shuffle partition files in LevelDB,
and restore the meta after restarting workers, also workers should keep a stable service port to support
<code>ShuffleClient</code> retry reading data. Users should set <code>celeborn.worker.graceful.shutdown.enabled</code> to <code>true</code> and
set below service port with stable port to support worker recover status.</p>
<pre><code>rss.worker.rpc.port
rss.fetchserver.port
rss.pushserver.port
rss.replicateserver.port
</code></pre>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
      
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: Home" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Home
            </div>
          </div>
        </a>
      
      
        
        <a href="../contrib/docs_and_website/" class="md-footer__link md-footer__link--next" aria-label="Next: Docs and Website" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Docs and Website
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking"], "search": "../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": "0.2.0-SNAPSHOT"}</script>
    
    
      <script src="../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>